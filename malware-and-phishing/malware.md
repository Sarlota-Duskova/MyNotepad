# Malware



* If it encrypts files - it's **Ransomware**
* If it records information like keystrokes or displays adware - we can classify it as **Spyware**.

**Provided Static Analysis Tools:**

C:\Users\Analysis\Desktop\Tools\Static\PE Tools

* Dependency Walker (depends)
* PeID
* PE Explorer
* PEview
* ResourceHacker

C:\Users\Analysis\Desktop\Tools\Static\Disassembly

* IDA Freeware
* WinDbg

C:\Users\Analysis\Desktop\Tools\Sysinternalsuite

* ResourceHacker

C:\Users\Analysis\Desktop\Tools\Dynamic

## REMnux

https://docs.remnux.org

## Analysing Malicious PDFs

### Embedded Javascript

1. Look for the presence of Javascript `peepdf demo_notsuspicious.pdf`
2.  Extract any contained Javascript for us to read without it being executed.

    * create a script file for peepdf to use: `echo 'extract js > javascript-from-demo_notsuspicious.pdf' > extracted_javascript.txt`

    `peepdf -s extracted_javascript.txt demo_notsuspicious.pdf`

## Analysing Malicious Microsoft Office Macros

`vmonkey DefinitelyALegitInvoice.doc`

* `vmonkey` has detected potentially malicious visual basic code within a macro.

## Memory Forensics

**Cheatsheet:** https://downloads.volatilityfoundation.org/releases/2.4/CheatSheet\_v2.4.pdf

`volatility -f Win7-Jigsaw.raw imageinfo`

**We can list the processes that were running via pslist:** `volatility -f Win7-Jigsaw.raw --profile=Win7SP1x64 pslist`

**List the DLL's that "drpbx.exe" references with dlllist:** `volatility -f Win7-Jigsaw.raw --profile=Win7SP1x64 dlllist -p 3704`

_**DLL (Dynamic Link Library)**, is a library that contains code and data that can be used by more than one program at the same time._
